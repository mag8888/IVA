# –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Django Backend –Ω–∞ Railway

## ‚ö†Ô∏è –í–∞–∂–Ω–æ: –ù—É–∂–µ–Ω –û–¢–î–ï–õ–¨–ù–´–ô —Å–µ—Ä–≤–∏—Å!

–°–µ–π—á–∞—Å —É –≤–∞—Å –µ—Å—Ç—å:
- ‚úÖ **Postgres** (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö) - –Ω–∏—á–µ–≥–æ –º–µ–Ω—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ
- ‚úÖ **IVA** (Node.js backend) - —Å—Ç–∞—Ä—ã–π –±—ç–∫–µ–Ω–¥

**–ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å:**
- üÜï **–ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è Django Backend** (–≥–¥–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å Telegram –±–æ—Ç)

## –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å

1. –í Railway Dashboard –Ω–∞–∂–º–∏—Ç–µ **"+ New"** (–≤–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞)
2. –í—ã–±–µ—Ä–∏—Ç–µ **"GitHub Repo"**
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `mag8888/IVA`
4. **–í–ê–ñ–ù–û**: –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
   - **Service Name**: `django-backend` (–∏–ª–∏ `iva-django`)
   - **Root Directory**: `backend_django` ‚≠ê **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!**
   - Build/Start –∫–æ–º–∞–Ω–¥—ã –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º–∏

## –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –ù–û–í–´–ô Django —Å–µ—Ä–≤–∏—Å

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞, –æ—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"Variables"**.

### –°–∫–æ–ø–∏—Ä—É–π—Ç–µ DATABASE_URL –∏–∑ Postgres:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–∏—Å **"Postgres"** ‚Üí –≤–∫–ª–∞–¥–∫–∞ **"Variables"**
2. –ù–∞–π–¥–∏—Ç–µ `DATABASE_URL`
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç—Ä–∏ —Ç–æ—á–∫–∏ —Å–ø—Ä–∞–≤–∞ ‚Üí **"Copy Value"**
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–æ–≤—ã–π Django —Å–µ—Ä–≤–∏—Å ‚Üí **"Variables"** ‚Üí **"+ New Variable"**
5. –î–æ–±–∞–≤—å—Ç–µ: `DATABASE_URL` = (–≤—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)

### –î–æ–±–∞–≤—å—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

–ù–∞–∂–º–∏—Ç–µ **"+ New Variable"** –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–æ –æ–¥–Ω–æ–π:

```bash
# 1. Django –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
DJANGO_SECRET_KEY = md*3-haow%@+i(c=mrsk!%jywy9%x_*1yv^+t5yw3&y+qw01ne
DJANGO_DEBUG = False
RAILWAY_PUBLIC_DOMAIN = django-backend.up.railway.app
# (–∏–ª–∏ –¥—Ä—É–≥–æ–π –¥–æ–º–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π Railway –Ω–∞–∑–Ω–∞—á–∏—Ç)

# 2. Telegram Bot
TELEGRAM_BOT_TOKEN = <–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞>
TELEGRAM_WEBHOOK_URL = https://django-backend.up.railway.app/telegram/webhook/
TELEGRAM_WEBAPP_URL = https://django-backend.up.railway.app

# 3. CORS –∏ Hosts
CORS_ALLOWED_ORIGINS = https://iva.up.railway.app
DJANGO_ALLOWED_HOSTS = django-backend.up.railway.app,iva.up.railway.app

# 4. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (MLM –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
MAX_PARTNERS_PER_LEVEL = 3
DEFAULT_GREEN_BONUS_PERCENT = 50
DEFAULT_YELLOW_BONUS_PERCENT = 50
```

## –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Root Directory

1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤—ã–π Django —Å–µ—Ä–≤–∏—Å
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"Settings"**
3. –ù–∞–π–¥–∏—Ç–µ **"Root Directory"**
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–∫–∞–∑–∞–Ω–æ: `backend_django`
5. –ï—Å–ª–∏ –Ω–µ—Ç - –∏–∑–º–µ–Ω–∏—Ç–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ

## –®–∞–≥ 4: –î–æ–∂–¥–∏—Ç–µ—Å—å –¥–µ–ø–ª–æ—è

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–Ω–µ—Ç –¥–µ–ø–ª–æ–π.

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

–í –ª–æ–≥–∞—Ö –Ω–æ–≤–æ–≥–æ Django —Å–µ—Ä–≤–∏—Å–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```
‚úÖ Telegram –±–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
‚úÖ Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: https://django-backend.up.railway.app/telegram/webhook/
‚úÖ Telegram –±–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ Webhook
```

## –®–∞–≥ 5: –û–±–Ω–æ–≤–∏—Ç–µ TELEGRAM_WEBHOOK_URL

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è Railway –Ω–∞–∑–Ω–∞—á–∏—Ç –¥–æ–º–µ–Ω. –û–±–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Django —Å–µ—Ä–≤–∏—Å ‚Üí **"Settings"** ‚Üí **"Generate Domain"** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä: `django-backend-production.up.railway.app`)
3. –û–±–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
   - `RAILWAY_PUBLIC_DOMAIN` = –≤–∞—à_–¥–æ–º–µ–Ω
   - `TELEGRAM_WEBHOOK_URL` = https://–≤–∞—à_–¥–æ–º–µ–Ω/telegram/webhook/
   - `TELEGRAM_WEBAPP_URL` = https://–≤–∞—à_–¥–æ–º–µ–Ω
   - `DJANGO_ALLOWED_HOSTS` = –≤–∞—à_–¥–æ–º–µ–Ω,iva.up.railway.app

## –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–æ–≤:

```
Railway Project
‚îÇ
‚îú‚îÄ‚îÄ Postgres ‚úÖ (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
‚îÇ   ‚îî‚îÄ‚îÄ –ù–∏—á–µ–≥–æ –º–µ–Ω—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ
‚îÇ
‚îú‚îÄ‚îÄ IVA ‚úÖ (Node.js backend - —Å—Ç–∞—Ä—ã–π)
‚îÇ   ‚îî‚îÄ‚îÄ –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∏–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
‚îÇ
‚îî‚îÄ‚îÄ django-backend üÜï (Django backend - –Ω–æ–≤—ã–π)
    ‚îú‚îÄ‚îÄ Root Directory: backend_django
    ‚îî‚îÄ‚îÄ –ó–¥–µ—Å—å —Ä–∞–±–æ—Ç–∞–µ—Ç Telegram –±–æ—Ç
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

1. **Healthcheck:**
   ```bash
   curl https://–≤–∞—à-–¥–æ–º–µ–Ω-django/health/
   ```

2. **Webhook:**
   ```bash
   curl "https://api.telegram.org/bot<TOKEN>/getWebhookInfo"
   ```

3. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É** ‚Üí –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å
