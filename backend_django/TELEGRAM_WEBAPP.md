# Telegram Web App - Мини-приложение для MLM структуры

## Описание

Мини-приложение для Telegram бота, которое отображает MLM структуру пользователя. Вызывается командой `/app` в боте.

## Функционал

### Отображение структуры
- Дерево MLM структуры пользователя
- Уровни и позиции партнеров
- Тарифы партнеров
- Визуальная иерархия

### Статистика
- Количество партнеров в структуре
- Общая сумма бонусов (из БД)
- Зеленые бонусы (из БД)
- Желтые бонусы (из БД)

### Интеграция с Telegram
- Использует Telegram Web App API
- Адаптивный дизайн под Telegram
- Поддержка тем Telegram (светлая/темная)
- Кнопка обновления данных

## URL

Мини-приложение доступно по адресу:
```
https://your-backend.railway.app/telegram-app/
```

## Настройка

### Переменные окружения

В Railway для Backend сервиса добавьте:
```
TELEGRAM_WEBAPP_URL=https://your-backend.railway.app
```

Или используйте автоматический домен Railway:
```
RAILWAY_PUBLIC_DOMAIN=your-backend.up.railway.app
```

### Команда в боте

Команда `/app` автоматически создает кнопку для открытия мини-приложения.

## Принцип работы

1. **Пользователь нажимает `/app` в боте**
2. **Бот отправляет кнопку** с Web App URL
3. **Пользователь нажимает кнопку** → открывается мини-приложение
4. **Мини-приложение загружает данные** из API:
   - `/api/structure/tree/` - структура MLM
   - `/api/bonuses/?user_id=X` - бонусы пользователя
5. **Отображает структуру и статистику** (все данные из БД)

## Особенности

- ✅ Все данные из базы данных
- ✅ Адаптивный дизайн
- ✅ Поддержка тем Telegram
- ✅ Автоматическое обновление
- ✅ Оптимизировано для мобильных устройств

## Тестирование

1. Запустите бота в Telegram
2. Отправьте команду `/app`
3. Нажмите на кнопку "Открыть мою структуру"
4. Мини-приложение откроется в Telegram

## Безопасность

- Мини-приложение работает через HTTPS
- Данные загружаются через API
- Пользователь видит только свою структуру (можно добавить фильтрацию по user_id)

