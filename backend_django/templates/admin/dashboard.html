{% extends "admin/base_site.html" %}
{% load static %}

{% block extrastyle %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static 'admin/css/dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-header">
    <h1>üìä Dashboard - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã</h1>
</div>

<div class="dashboard-stats">
    <div class="stat-card blue">
        <h3>üë• –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
        <p class="value">{{ total_users }}</p>
    </div>
    <div class="stat-card green">
        <h3>‚úÖ –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
        <p class="value">{{ active_users }}</p>
    </div>
    <div class="stat-card purple">
        <h3>üí≥ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ–ø–ª–∞—Ç–æ–π</h3>
        <p class="value">{{ users_with_payments }}</p>
    </div>
    <div class="stat-card orange">
        <h3>üí∞ –û–±—â–∏–π –¥–æ—Ö–æ–¥</h3>
        <p class="value">${{ total_revenue|floatformat:2 }}</p>
    </div>
</div>

<div class="dashboard-stats">
    <div class="stat-card blue">
        <h3>üìù –í—Å–µ–≥–æ –ø–ª–∞—Ç–µ–∂–µ–π</h3>
        <p class="value">{{ total_payments }}</p>
    </div>
    <div class="stat-card green">
        <h3>‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ</h3>
        <p class="value">{{ completed_payments }}</p>
    </div>
    <div class="stat-card orange">
        <h3>‚è≥ –û–∂–∏–¥–∞–µ—Ç</h3>
        <p class="value">{{ pending_payments }}</p>
    </div>
    <div class="stat-card purple">
        <h3>üéÅ –í—Å–µ–≥–æ –±–æ–Ω—É—Å–æ–≤</h3>
        <p class="value">${{ total_bonuses|floatformat:2 }}</p>
    </div>
</div>

<div class="dashboard-stats">
    <div class="stat-card green">
        <h3>üíö –ó–µ–ª–µ–Ω—ã–µ –±–æ–Ω—É—Å—ã</h3>
        <p class="value">${{ green_bonuses|floatformat:2 }}</p>
    </div>
    <div class="stat-card orange">
        <h3>üíõ –ñ–µ–ª—Ç—ã–µ –±–æ–Ω—É—Å—ã</h3>
        <p class="value">${{ yellow_bonuses|floatformat:2 }}</p>
    </div>
    <div class="stat-card blue">
        <h3>üå≥ –£–∑–ª–æ–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã</h3>
        <p class="value">{{ total_nodes }}</p>
    </div>
    <div class="stat-card purple">
        <h3>üìà –ó–∞ 30 –¥–Ω–µ–π</h3>
        <p class="value">{{ recent_users }} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
    </div>
</div>

<div class="dashboard-section">
    <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º</h2>
    <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    <th>–¢–∞—Ä–∏—Ñ</th>
                    <th>–ü–ª–∞—Ç–µ–∂–µ–π</th>
                    <th>–û–±—â–∞—è —Å—É–º–º–∞</th>
                </tr>
            </thead>
            <tbody>
                {% for stat in tariffs_stats %}
                <tr>
                    <td><strong>{{ stat.tariff.name }}</strong> (${{ stat.tariff.entry_amount|floatformat:2 }})</td>
                    <td>{{ stat.count }}</td>
                    <td class="money">${{ stat.total|floatformat:2 }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="3" class="empty-state">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="dashboard-section">
    <h2>üëë –¢–æ–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –±–∞–ª–∞–Ω—Å—É</h2>
    <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                    <th>Email</th>
                    <th>–ë–∞–ª–∞–Ω—Å</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                </tr>
            </thead>
            <tbody>
                {% for user in top_users_balance %}
                <tr>
                    <td><a href="{% url 'admin:core_user_change' user.id %}">{{ user.username }}</a></td>
                    <td>{{ user.email }}</td>
                    <td class="money">${{ user.balance|floatformat:2 }}</td>
                    <td>{{ user.get_status_display }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" class="empty-state">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="dashboard-section">
    <h2>üéÅ –¢–æ–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –±–æ–Ω—É—Å–∞–º</h2>
    <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                    <th>Email</th>
                    <th>–í—Å–µ–≥–æ –±–æ–Ω—É—Å–æ–≤</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                </tr>
            </thead>
            <tbody>
                {% for user in top_users_bonuses %}
                <tr>
                    <td><a href="{% url 'admin:core_user_change' user.id %}">{{ user.username }}</a></td>
                    <td>{{ user.email }}</td>
                    <td class="money">${{ user.total_bonuses|floatformat:2 }}</td>
                    <td>{{ user.get_status_display }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" class="empty-state">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="dashboard-section">
    <h2>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</h2>
    <div class="dashboard-stats">
        <div class="stat-card blue">
            <h3>–ù–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
            <p class="value">{{ recent_users }}</p>
        </div>
        <div class="stat-card green">
            <h3>–ù–æ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π</h3>
            <p class="value">{{ recent_payments }}</p>
        </div>
        <div class="stat-card purple">
            <h3>–î–æ—Ö–æ–¥ –∑–∞ –ø–µ—Ä–∏–æ–¥</h3>
            <p class="value">${{ recent_revenue|floatformat:2 }}</p>
        </div>
    </div>
</div>
{% endblock %}
