# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Mini App

## –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

‚úÖ –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è MLM —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ Telegram –±–æ—Ç–µ
‚úÖ –ö–æ–º–∞–Ω–¥–∞ `/app` –≤ –±–æ—Ç–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞—Ä—Ç–Ω–µ—Ä–∫–∏
‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ–Ω—É—Å–æ–≤ –∏–∑ –ë–î

## URL –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```
https://your-backend.railway.app/telegram-app/
```

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –î–µ—Ä–µ–≤–æ MLM —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –£—Ä–æ–≤–Ω–∏ –∏ –ø–æ–∑–∏—Ü–∏–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
- –¢–∞—Ä–∏—Ñ—ã –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
- –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–∏–∑ –ë–î)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
- –û–±—â–∞—è —Å—É–º–º–∞ –±–æ–Ω—É—Å–æ–≤ (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã Bonus)
- –ó–µ–ª–µ–Ω—ã–µ –±–æ–Ω—É—Å—ã (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã Bonus)
- –ñ–µ–ª—Ç—ã–µ –±–æ–Ω—É—Å—ã (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã Bonus)

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Telegram Web App API
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –ø–æ–¥ Telegram
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º Telegram (—Å–≤–µ—Ç–ª–∞—è/—Ç–µ–º–Ω–∞—è)
- –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ Railway

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Backend

–î–æ–±–∞–≤—å—Ç–µ –≤ Backend —Å–µ—Ä–≤–∏—Å:
```
TELEGRAM_WEBAPP_URL=https://your-backend.up.railway.app
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–æ–º–µ–Ω:
```
RAILWAY_PUBLIC_DOMAIN=your-backend.up.railway.app
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/app`
3. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç –∫–Ω–æ–ø–∫—É "üå≥ –û—Ç–∫—Ä—ã—Ç—å –º–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É"
4. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É ‚Üí –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
5. –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∑ API

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ö–æ–º–∞–Ω–¥–∞ /app
```python
# –í integrations/telegram.py
async def app_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    # –°–æ–∑–¥–∞–µ—Ç –∫–Ω–æ–ø–∫—É —Å Web App URL
    keyboard = [[InlineKeyboardButton(
        "üå≥ –û—Ç–∫—Ä—ã—Ç—å –º–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É",
        web_app={"url": f"{webapp_url}/telegram-app/"}
    )]]
```

### 2. –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞: `templates/telegram_app/index.html`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Telegram Web App API
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ API:
  - `/api/structure/` - —Å–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤
  - `/api/structure/tree/` - –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
  - `/api/bonuses/?user_id=X` - –±–æ–Ω—É—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–ª—É—á–∞–µ—Ç Telegram User ID –∏–∑ `tg.initDataUnsafe.user`
- –ò—â–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î –ø–æ username (Telegram ID –∏–ª–∏ username)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã StructureNode
- ‚úÖ –ë–æ–Ω—É—Å—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Bonus
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

### –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º Telegram
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ HTTPS
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ API
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Å–≤–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Django —Å–µ—Ä–≤–µ—Ä:
```bash
python manage.py runserver
```

2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://localhost:8000/telegram-app/
```

3. –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Telegram:
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ ngrok –∏–ª–∏ –¥—Ä—É–≥–æ–π —Ç—É–Ω–Ω–µ–ª—å
   - –£–∫–∞–∂–∏—Ç–µ URL –≤ `TELEGRAM_WEBAPP_URL`

### –ù–∞ Railway

1. –î–µ–ø–ª–æ–π Backend –Ω–∞ Railway
2. –î–æ–±–∞–≤—å—Ç–µ `TELEGRAM_WEBAPP_URL` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Backend
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/app` –≤ –±–æ—Ç–µ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
backend_django/
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ telegram_app/
‚îÇ       ‚îî‚îÄ‚îÄ index.html          # –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ integrations/
‚îÇ   ‚îî‚îÄ‚îÄ telegram.py             # –ö–æ–º–∞–Ω–¥–∞ /app
‚îî‚îÄ‚îÄ equilibrium_backend/
    ‚îî‚îÄ‚îÄ urls.py                 # URL: /telegram-app/
```

## –£–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —É—Ä–æ–≤–Ω—è–º
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∏—Å–∫ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞—Ä—Ç–Ω–µ—Ä–µ
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –±–æ–Ω—É—Å–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

